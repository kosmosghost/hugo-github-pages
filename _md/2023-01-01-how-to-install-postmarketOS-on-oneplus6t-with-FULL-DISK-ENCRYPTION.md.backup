You are going to need a few tools before you can install postmarketOS with full disk encryption on the oneplus6/t device:

1) Android tools for fastboot.

2) pmbootstrap - pip install pmbootstrap

Note: This tutorial assumes you have your oneplus6/t device unlocked. I will add future instructions here on how to do that.

Warning: I have not tried this with dual booting android.


Here is how I installed postmarketOS on my oneplus6t with FULL DISK ENCRYPTION. You will need to get into what I call the fastboot screen by holding both volume buttons and presssing the power button on your phone. Once you see the fastboot symbol, let go of the power button, but still hold the volume buttons.

Tip: I could never get full disk encryption to work on boot slot_b. I was able to get it working on slot_a. I don't know if this was user error, or something else, so I would suggest using slot_a for this tutorial. Example:

```

fastboot set_active a
```


Warning: This will mess up android if you want to dual boot.


```
fastboot erase dtbo
```


```
pmbootstrap init
```

Simply follow the prompts and select oneplus as the vendor, and enchilada if using the oneplus6 or fajita if using oneplus6t.

Next build the system:

```
pmbootstrap install --fde --split --filesystem btrfs

```

I chose `--filesystem btrfs` for this because I like btrfs, and it's easier to install on the oneplus6/t devices with btrfs. You can ignore this if you want chose the default, which is ext4. I will have instructions for btrfs and regular ext4 at the end of this tutorial.

```
pmbootstrap export
```

Again, just follow the prompts. pmbootstrap will create a link into /tmp/postmarketOS-export/.

```

fastboot erase boot
fastboot erase vendor
fastboot erase userdata
```

This is going to erase the bootloader on the boot slot. The next commands will install a new bootloader that will boot PostmarketOS. Erasing userdata will probably delete the data on your Android partition. This method only works when not dual booting.

When inside the postmarketOS-export directory run if flashing to the oneplus6:

```

fastboot flash boot boot.img
fastboot flash vendor oneplus-enchilada-boot.img
fastboot flash userdata oneplus-enchilada-root.img


```

Or if flashing to the oneplus6t:


```

fastboot flash boot boot.img
fastboot flash vendor oneplus-fajita-boot.img
fastboot flash userdata oneplus-fajita-root.img
```

Once everything is flashed turn off the device. Reboot, and make sure that everything is working as it should. As of this writing postmarketOS does not correctly size the storage on your device. It is very important to boot the device, and then restart, before you resize the storage. 


Next download the jumpdrive enchilada/fajita boot image from [github](https://github.com/dreemurrs-embedded/Jumpdrive/releases) and run:

```
fastboot boot jumpdrive.img
```

The phone will boot into the jumpdrive os and show as a block device when connected to your computer using a usb cable. In my case it was sda.

Run `cryptsetup open /dev/sdx oneplus` and enter your password for unlocking the device.

In this very order run if you used btrfs for the filesystem:

```
cryptsetup resize oneplus
btrfs resize max /dev/mapper/oneplus
```

Or for ext4:

```
cryptsetup resize oneplus

e2fsck -f /dev/mapper/oneplus

resize2fs /dev/mapper/oneplus
```

And now when you reboot everything should be working!